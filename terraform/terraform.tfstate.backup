{
  "version": 4,
  "terraform_version": "0.12.24",
  "serial": 84,
  "lineage": "9d31ff15-ec7d-3471-10de-e6d0e6f6b219",
  "outputs": {
    "ip": {
      "value": "15.164.105.208",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "template_file",
      "name": "init_script",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "20e6f1c77994b98a8e49585d43d622c6f90f7b39aa9cc9ee61fbbf6e391b8962",
            "rendered": "#!/bin/bash\n\nMY_HOME=\"/home/ubuntu\"\nexport DEBIAN_FRONTEND=noninteractive\n\napt update\napt install -y python3-pip curl git awscli apt-transport-https ca-certificates software-properties-common\n\nsudo bash -c \"sed -i '1,15s/#Port 22/#Port 22\\nPort 40022/g' /etc/ssh/sshd_config\"\nsudo systemctl restart sshd\n\naws configure \u003c\u003c EOF\nAKIA2OH3JZ7RFUK5Q6XL\noYtKriRW1ads0jMh6KiMoeOlzAwFP8b2vwI98Pfw\nap-northeast-2\njson\nEOF\n\naws lightsail put-instance-public-ports --instance-name=devops-main --port-info fromPort=40022,toPort=40022,protocol=tcp fromPort=443,toPort=443,protocol=tcp fromPort=80,toPort=80,protocol=tcp\n\n#aws lightsail close-instance-public-ports --instance-name=devops-main --port-info fromPort=22,toPort=22,protocol=tcp\n\n# Install docker\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nsudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\napt update\napt-cache policy docker-ce\napt install -y docker-ce\n\n# Install docker-ce\nsu ubuntu -c \"mkdir -p $MY_HOME/.local/bin\"\nsu ubuntu -c \"pip3 install docker-compose --upgrade --user \u0026\u0026 chmod 754 $MY_HOME/.local/bin/docker-compose\"\nusermod -aG docker ubuntu\n\n# Add PATH\nprintf \"\\nexport PATH=\\$PATH:$MY_HOME/.local/bin\\n\" \u003e\u003e $MY_HOME/.bashrc\n\nexit 0\n",
            "template": "#!/bin/bash\n\nMY_HOME=\"/home/ubuntu\"\nexport DEBIAN_FRONTEND=noninteractive\n\napt update\napt install -y python3-pip curl git awscli apt-transport-https ca-certificates software-properties-common\n\nsudo bash -c \"sed -i '1,15s/#Port 22/#Port 22\\nPort 40022/g' /etc/ssh/sshd_config\"\nsudo systemctl restart sshd\n\naws configure \u003c\u003c EOF\nAKIA2OH3JZ7RFUK5Q6XL\noYtKriRW1ads0jMh6KiMoeOlzAwFP8b2vwI98Pfw\nap-northeast-2\njson\nEOF\n\naws lightsail put-instance-public-ports --instance-name=devops-main --port-info fromPort=40022,toPort=40022,protocol=tcp fromPort=443,toPort=443,protocol=tcp fromPort=80,toPort=80,protocol=tcp\n\n#aws lightsail close-instance-public-ports --instance-name=devops-main --port-info fromPort=22,toPort=22,protocol=tcp\n\n# Install docker\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nsudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\napt update\napt-cache policy docker-ce\napt install -y docker-ce\n\n# Install docker-ce\nsu ubuntu -c \"mkdir -p $MY_HOME/.local/bin\"\nsu ubuntu -c \"pip3 install docker-compose --upgrade --user \u0026\u0026 chmod 754 $MY_HOME/.local/bin/docker-compose\"\nusermod -aG docker ubuntu\n\n# Add PATH\nprintf \"\\nexport PATH=\\$PATH:$MY_HOME/.local/bin\\n\" \u003e\u003e $MY_HOME/.bashrc\n\nexit 0\n",
            "vars": null
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lightsail_instance",
      "name": "main",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lightsail:ap-northeast-2:717786566626:Instance/a5e53eec-e007-4646-8cc0-f1f35b65c183",
            "availability_zone": "ap-northeast-2a",
            "blueprint_id": "ubuntu_18_04",
            "bundle_id": "nano_2_0",
            "cpu_count": 1,
            "created_at": "2020-05-15T04:00:14Z",
            "id": "devops-main",
            "ipv6_address": "",
            "is_static_ip": false,
            "key_pair_name": "terraform",
            "name": "devops-main",
            "private_ip_address": "172.26.15.74",
            "public_ip_address": "13.125.50.159",
            "ram_size": null,
            "tags": null,
            "user_data": "#!/bin/bash\n\nMY_HOME=\"/home/ubuntu\"\nexport DEBIAN_FRONTEND=noninteractive\n\napt update\napt install -y python3-pip curl git awscli apt-transport-https ca-certificates software-properties-common\n\nsudo bash -c \"sed -i '1,15s/#Port 22/#Port 22\\nPort 40022/g' /etc/ssh/sshd_config\"\nsudo systemctl restart sshd\n\naws configure \u003c\u003c EOF\nAKIA2OH3JZ7RFUK5Q6XL\noYtKriRW1ads0jMh6KiMoeOlzAwFP8b2vwI98Pfw\nap-northeast-2\njson\nEOF\n\naws lightsail put-instance-public-ports --instance-name=devops-main --port-info fromPort=40022,toPort=40022,protocol=tcp fromPort=443,toPort=443,protocol=tcp fromPort=80,toPort=80,protocol=tcp\n\n#aws lightsail close-instance-public-ports --instance-name=devops-main --port-info fromPort=22,toPort=22,protocol=tcp\n\n# Install docker\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nsudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\napt update\napt-cache policy docker-ce\napt install -y docker-ce\n\n# Install docker-ce\nsu ubuntu -c \"mkdir -p $MY_HOME/.local/bin\"\nsu ubuntu -c \"pip3 install docker-compose --upgrade --user \u0026\u0026 chmod 754 $MY_HOME/.local/bin/docker-compose\"\nusermod -aG docker ubuntu\n\n# Add PATH\nprintf \"\\nexport PATH=\\$PATH:$MY_HOME/.local/bin\\n\" \u003e\u003e $MY_HOME/.bashrc\n\nexit 0\n",
            "username": "ubuntu"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_lightsail_key_pair.deployer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lightsail_key_pair",
      "name": "deployer",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lightsail:ap-northeast-2:717786566626:KeyPair/ebffc627-6ea4-4a0e-8c65-889f5d3630dd",
            "encrypted_fingerprint": null,
            "encrypted_private_key": null,
            "fingerprint": "8b:a9:e3:97:e9:9c:31:4d:2f:ef:ff:5c:58:3b:a9:1f",
            "id": "terraform",
            "name": "terraform",
            "name_prefix": null,
            "pgp_key": null,
            "private_key": null,
            "public_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCsC7xZitw+TVADVq9+8KBEB+p1UikpjQ9Aqule8f2yDhO4QJUJayOexDK437ZIz5fJjvJoAb3/bCQOM2nnW2PcgnUcxBhZmAvl+/Q9s+spIwdQh0wHcKEXpr/sXj78Z1UO4yMk+R9vjOa8YRTnl7WkEwbP7GXHb5t8dKgMpGxG1WoS6DulIiRgkLzR1AZye7rQpbE6SmIlzuhRY9/NotxZiRDdOdmMvw2Mg5v9F8EST88A6+CWWuw0BFNu4L6PThHT4aRzBBZcNZngPmQz/4yOkOoEi2onrsvppDivPpe2FGI1BlN6pML0TBau8cfhGwBXQ8FdSvn3bPoTq7y6xndTmmHbZjuOPZ86JtjwacP7YN4h7SzLIIsZV3MWG2uvFGI2TC81MCE968G605DTQm/M6ZNmuorlaCBcMwog91o4Hz6QUpl66nZ4MLzt1S9Uth2r4wW5Movf9PLogxtG6OBUWClqMtUEKRqbgBgzw8Xd1ungXseg2dOSk7xs1i+6IsBXf4iUatg2OzaWKvlVDUozMT9tYttVqzTy2ascY1IXUiPjwIkrn8GHamm/e3hmLa/o94z4DNhC2FPxJYZWlN6ECw3msZ4dZLzROp0UDec+hRcWmzEK8tOxIx6EepCiqPqHCmbSYuT5RjcO0/YjM2rJEdu89TgBVITqEb2BGZMzTw== dlsrks1218@daum.net\n"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lightsail_static_ip",
      "name": "devops",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lightsail:ap-northeast-2:717786566626:StaticIp/8d3c77dc-5870-4f1f-83a8-d90188a4df28",
            "id": "lsstaticip",
            "ip_address": "15.164.105.208",
            "name": "lsstaticip",
            "support_code": "900090476579/15.164.105.208"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lightsail_static_ip_attachment",
      "name": "devops",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "lsstaticip",
            "instance_name": "devops-main",
            "ip_address": "15.164.105.208",
            "static_ip_name": "lsstaticip"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_lightsail_instance.main",
            "aws_lightsail_key_pair.deployer",
            "aws_lightsail_static_ip.devops"
          ]
        }
      ]
    }
  ]
}
